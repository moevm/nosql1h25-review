<div style="display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 20px;">
  <h2 style="margin: 0;">My Account</h2>
  <span style="color: gray; font-size: 0.9rem; text-align: right;">
    Created at: {{ user.createdAt }} | Last modified: {{ user.lastModified }}
  </span>
</div>

<div class="account-content">
  <!-- Табы -->
  <div class="tabs" style="display: flex; border-bottom: 2px solid #eee; margin-bottom: 20px;">
    <button class="tab-button active" data-tab="personal">Change Personal Info</button>
    <button class="tab-button" data-tab="password">Change Password</button>
    <button class="tab-button" data-tab="addgame">Add Game Card</button>
  </div>

  <!-- Personal Info Form -->
  <div class="tab-content active" id="tab-personal">
    <form method="post" enctype="multipart/form-data" id="ChangePersonalDataForm" style="display: flex; flex-direction: column; gap: 15px;">
      {% csrf_token %}
      <input type="hidden" name="form_type" value="personal">

      {% for field in personal_form %}
        <div class="form-group" style="display: flex; flex-direction: column; width: 50%;">
          {{ field.label_tag }}
          {{ field.errors }}
          {{ field }}
          {{ field.help_text }}
        </div>
      {% endfor %}

      <button type="submit" style="width: 25%; background-color: #FFBD3F; color: black; padding: 12px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; font-size: 1rem; margin-top: 20px;">
        Save
      </button>
    </form>
  </div>

  <!-- Password Change Form -->
  <div class="tab-content" id="tab-password" style="display: none;">
    <form method="post" id="ChangePasswordForm" style="display: flex; flex-direction: column; gap: 15px;">
      {% csrf_token %}
      <input type="hidden" name="form_type" value="password">

      {% for field in password_form %}
        <div class="form-group" style="display: flex; flex-direction: column; width: 50%;">
          {{ field.label_tag }}
          {{ field.errors }}
          {{ field }}
          {{ field.help_text }}
        </div>
      {% endfor %}

      <button type="submit" style="width: 25%; background-color: #FFBD3F; color: black; padding: 12px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; font-size: 1rem; margin-top: 20px;">
        Save New Password
      </button>
    </form>
  </div>

<!-- Add Game Card Form -->
<div class="tab-content" id="tab-addgame" style="display: none;">
  <form method="post" enctype="multipart/form-data" id="AddGameCardForm" style="display: flex; flex-direction: column; gap: 30px; width: 100%; font-family: 'Inter', sans-serif;">
    {% csrf_token %}
    <input type="hidden" name="form_type" value="addgame">

    <div style="display: flex; gap: 40px; align-items: flex-start;">

      <!-- Левая колонка: Загрузка изображения -->
      <div style="flex-shrink: 0; display: flex; flex-direction: column; align-items: center; gap: 10px;">
        <label for="gameImageUpload" style="cursor: pointer; width: 176px; height: 264px; background-color: #f0f0f0; border: 2px dashed #ccc; border-radius: 8px; display: flex; align-items: center; justify-content: center; overflow: hidden;">
          <img id="gameImagePreview" src="#" alt="Game Image Preview" style="display: none; width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
        </label>
        <input type="file" id="gameImageUpload" name="game_image" accept="image/*" style="display: none;" onchange="previewGameImage(event)">
        <span id="uploadText" style="font-size: 14px; color: gray;">Click to upload game image</span>
      </div>

      <!-- Правая колонка: Поля + Чекбоксы -->
      <div style="flex: 1; display: flex; gap: 40px;">

        <!-- Текстовые поля -->
        <div style="flex: 1; display: flex; flex-direction: column; gap: 15px;">
          <div style="display: flex; flex-direction: column; gap: 5px;">
            <label style="font-weight: 600; font-size: 14px;">Name:</label>
            <input type="text" name="name" style="padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px;">
          </div>

          <div style="display: flex; flex-direction: column; gap: 5px;">
            <label style="font-weight: 600; font-size: 14px;">Description:</label>
            <textarea name="description" rows="3" style="padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px;"></textarea>
          </div>

          <div style="display: flex; flex-direction: column; gap: 5px;">
            <label style="font-weight: 600; font-size: 14px;">Released On:</label>
            <input type="date" name="released_on" style="padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px;">
          </div>

          <div style="display: flex; flex-direction: column; gap: 5px;">
            <label style="font-weight: 600; font-size: 14px;">Game Author:</label>
            <input type="text" name="game_author" style="padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px;">
          </div>
        </div>

        <!-- Чекбоксы -->
        <div style="flex: 1; display: flex; flex-direction: column; gap: 30px;">
          <div>
            <label style="font-weight: 700; font-size: 16px;">Platforms:</label>
            <div style="margin-top: 10px; display: flex; flex-direction: column; gap: 8px;">
              <label><input type="checkbox" name="platforms" value="PS5"> PS5</label>
              <label><input type="checkbox" name="platforms" value="Xbox Series X/S"> Xbox Series X/S</label>
              <label><input type="checkbox" name="platforms" value="Nintendo Switch"> Nintendo Switch</label>
              <label><input type="checkbox" name="platforms" value="PC"> PC</label>
              <label><input type="checkbox" name="platforms" value="Mobile"> Mobile</label>
            </div>
          </div>

          <div>
            <label style="font-weight: 700; font-size: 16px;">Genres:</label>
            <div style="margin-top: 10px; display: flex; flex-direction: column; gap: 8px;">
              <label><input type="checkbox" name="genres" value="Action"> Action</label>
              <label><input type="checkbox" name="genres" value="Adventure"> Adventure</label>
              <label><input type="checkbox" name="genres" value="Role-playing (RPG)"> Role-playing (RPG)</label>
              <label><input type="checkbox" name="genres" value="Strategy"> Strategy</label>
              <label><input type="checkbox" name="genres" value="Simulation"> Simulation</label>
              <label><input type="checkbox" name="genres" value="Sports"> Sports</label>
              <label><input type="checkbox" name="genres" value="Racing"> Racing</label>
              <label><input type="checkbox" name="genres" value="Fighting"> Fighting</label>
              <label><input type="checkbox" name="genres" value="Puzzle"> Puzzle</label>
              <label><input type="checkbox" name="genres" value="Horror"> Horror</label>
              <label><input type="checkbox" name="genres" value="Survival"> Survival</label>
              <label><input type="checkbox" name="genres" value="Battle Royale"> Battle Royale</label>
              <label><input type="checkbox" name="genres" value="MMORPG"> MMORPG</label>
              <label><input type="checkbox" name="genres" value="MOBA"> MOBA</label>
              <label><input type="checkbox" name="genres" value="Platformer"> Platformer</label>
              <label><input type="checkbox" name="genres" value="Stealth"> Stealth</label>
              <label><input type="checkbox" name="genres" value="Sandbox"> Sandbox</label>
              <label><input type="checkbox" name="genres" value="Open World"> Open World</label>
              <label><input type="checkbox" name="genres" value="First-person Shooter (FPS)"> First-person Shooter (FPS)</label>
              <label><input type="checkbox" name="genres" value="Third-person Shooter (TPS)"> Third-person Shooter (TPS)</label>
              <label><input type="checkbox" name="genres" value="Tactical Shooter"> Tactical Shooter</label>
              <label><input type="checkbox" name="genres" value="Roguelike"> Roguelike</label>
              <label><input type="checkbox" name="genres" value="Metroidvania"> Metroidvania</label>
              <label><input type="checkbox" name="genres" value="Visual Novel"> Visual Novel</label>
              <label><input type="checkbox" name="genres" value="Rhythm"> Rhythm</label>
              <label><input type="checkbox" name="genres" value="Party"> Party</label>
              <label><input type="checkbox" name="genres" value="Educational"> Educational</label>
              <label><input type="checkbox" name="genres" value="Card Game"> Card Game</label>
              <label><input type="checkbox" name="genres" value="Board Game"> Board Game</label>
              <label><input type="checkbox" name="genres" value="Trivia"> Trivia</label>
            </div>
          </div>
        </div>

      </div>

    </div>

    <!-- Кнопка по центру -->
    <div style="display: flex; justify-content: center; margin-top: 20px;">
      <button type="submit" style="width: 220px; background-color: #FFBD3F; color: black; padding: 14px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1.1rem; transition: 0.3s;">
        Save Game Card
      </button>
    </div>

  </form>
</div>

</div>

<!-- Стили табов -->
<style>
  .tab-button {
    padding: 10px 20px;
    border: none;
    background: none;
    font-weight: bold;
    cursor: pointer;
    font-size: 1rem;
    color: gray;
    border-bottom: 3px solid transparent;
    transition: all 0.3s;
  }

  .tab-button.active {
    color: black;
    border-bottom: 3px solid #FFBD3F;
    background-color: #fff8e5;
  }

  .tab-button:hover {
    color: #FFBD3F;
  }

  .tab-content {
    transition: all 0.3s;
  }
</style>

<!-- Скрипт переключения вкладок + превью картинки -->
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');

    tabButtons.forEach(button => {
      button.addEventListener('click', () => {
        const tab = button.getAttribute('data-tab');

        tabButtons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');

        tabContents.forEach(content => {
          if (content.id === 'tab-' + tab) {
            content.style.display = tab === "addgame" ? "flex" : "block";
            content.classList.add('active');
          } else {
            content.style.display = 'none';
            content.classList.remove('active');
          }
        });
      });
    });
  });

  function previewGameImage(event) {
    const reader = new FileReader();
    reader.onload = function() {
      const image = document.getElementById('gameImagePreview');
      const text = document.getElementById('uploadText');
      image.src = reader.result;
      image.style.display = 'block';
      text.style.display = 'none';
    };
    reader.readAsDataURL(event.target.files[0]);
  }
</script>